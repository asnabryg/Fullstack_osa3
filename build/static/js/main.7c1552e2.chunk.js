(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{23:function(e,n,t){},43:function(e,n,t){"use strict";t.r(n);var r=t(18),c=t.n(r),o=t(8),a=t(9),u=t(3),i=t(2),l=(t(23),t(0)),s=function(e){return Object(l.jsxs)("form",{onSubmit:e.addNewPerson,children:[Object(l.jsxs)("div",{children:["name: ",Object(l.jsx)("input",{value:e.newName,onChange:e.handleNameChange})]}),Object(l.jsxs)("div",{children:["number: ",Object(l.jsx)("input",{value:e.newNumber,onChange:e.handleNumberChange})]}),Object(l.jsx)("div",{children:Object(l.jsx)("button",{type:"submit",children:"add"})})]})},d=function(e){var n=e.person,t=e.handleDelete;return Object(l.jsxs)("p",{children:[n.name," ",n.number,Object(l.jsx)("button",{onClick:function(){return t(n.id)},children:"delete"})]})},f=function(e){var n=e.persons,t=e.handleDelete;return Object(l.jsx)("div",{children:n.map((function(e){return Object(l.jsx)(d,{person:e,handleDelete:t},e.name)}))})},j=function(e){return Object(l.jsx)("form",{children:Object(l.jsx)("input",{value:e.newFilter,onChange:e.handleFilterChange})})},b=t(5),h=t.n(b),m="/api/persons",O={getAll:function(){return h.a.get(m).then((function(e){return e.data}))},create:function(e){return h.a.post(m,e).then((function(e){return e.data}))},update:function(e,n){return h.a.put("".concat(m,"/").concat(e),n).then((function(e){return e.data}))},deletePerson:function(e){return h.a.delete("".concat(m,"/").concat(e))}},p=function(e){var n=e.notification;return null===n[1]?null:Object(l.jsx)("div",{className:"notification",style:{color:n[0]},children:n[1]})},v=function(){var e=Object(i.useState)([]),n=Object(u.a)(e,2),t=n[0],r=n[1],c=Object(i.useState)([null,null]),d=Object(u.a)(c,2),b=d[0],h=d[1];Object(i.useEffect)((function(){console.log("effect"),O.getAll().then((function(e){console.log("promise fulfilled"),r(e),y(e)}))}),[]);var m=Object(i.useState)(""),v=Object(u.a)(m,2),w=v[0],g=v[1],x=Object(i.useState)(""),C=Object(u.a)(x,2),N=C[0],L=C[1],S=Object(i.useState)(Object(o.a)(t)),D=Object(u.a)(S,2),k=D[0],y=D[1],A=Object(i.useState)(""),F=Object(u.a)(A,2),P=F[0],T=F[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Phonebook"}),Object(l.jsx)(p,{notification:b}),Object(l.jsx)(j,{newFilter:P,handleFilterChange:function(e){T(e.target.value),""===e.target.value?y(Object(o.a)(t)):y(t.filter((function(n){return n.name.toLowerCase().includes(e.target.value.toLowerCase())})))}}),Object(l.jsx)("h3",{children:"Add a new"}),Object(l.jsx)(s,{addNewPerson:function(e){e.preventDefault(),O.getAll().then((function(e){if(e.some((function(e){return e.name===w}))){if(window.confirm("".concat(w," is already added to phonebook, replace the old number with new one?"))){var n=e.find((function(e){return e.name===w})),t=Object(a.a)(Object(a.a)({},n),{},{number:N});O.update(n.id,t).then((function(t){var c=e.map((function(e){return e.id===n.id?t:e}));r(c),y(c.filter((function(e){return e.name.toLowerCase().includes(P.toLowerCase())}))),g(""),L("")})).catch((function(e){console.log("Error changing number:",e),h(["red",e.response.data.error]),setTimeout((function(){h([null,null])}),5e3)}))}}else{var c={name:w,number:N};O.create(c).then((function(n){var t=e.concat(n);r(t),g(""),L(""),y(t.filter((function(e){return e.name.toLowerCase().includes(P.toLowerCase())}))),h(["green","Added ".concat(n.name)]),setTimeout((function(){h([null,null])}),5e3)})).catch((function(e){console.log("Fail to add person: ".concat(c.name)),h(["red",e.response.data.error]),setTimeout((function(){h([null,null])}),5e3)}))}}))},newName:w,handleNameChange:function(e){g(e.target.value)},newNumber:N,handleNumberChange:function(e){L(e.target.value)}}),Object(l.jsx)("h3",{children:"Numbers"}),Object(l.jsx)(f,{persons:k,handleDelete:function(e){var n=t.find((function(n){return n.id===e}));window.confirm("Delete ".concat(n.name," ?"))&&O.deletePerson(e).then((function(){var n=t.filter((function(n){return n.id!==e}));r(n),y(n.filter((function(e){return e.name.toLowerCase().includes(P.toLowerCase())})))})).catch((function(){h(["red","Information of ".concat(n.name," has already been removed from server")]),setTimeout((function(){h([null,null])}),5e3);var c=t.filter((function(n){return n.id!==e}));r(c),y(c.filter((function(e){return e.name.toLowerCase().includes(P.toLowerCase())})))}))}})]})};c.a.render(Object(l.jsx)(v,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.7c1552e2.chunk.js.map